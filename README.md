# Dungeon AI

## Description
This project features an autonomous agent that uses computer vision to identify game states and make real time decisions to successfully complete a dungeon.

## Motivation
This project grew out of a curiosity for computer vision and the repetitive nature of grinding dungeons in the game *Realm of the Mad God*. The goal was to build an autonomous agent capable of playing through the entirety of the dungeon using only visual inputs, while also gaining hands on experience applying computer vision techniques to a real time setting.

## Installation

```bash
# Clone the repository
git clone https://github.com/YamatoMatsumura/dungeon-ai.git
cd dungeon-ai

# Install dependencies
pip install -r requirements.txt

# Run the project
python main.py
```

> Note: The player must be in the Pirate Cave dungeon as well as have the screen visible within two seconds after running main for the agent to function correctly.

## How It Works
1. Captures frames from the game window in real time
2. Applies computer vision techniques to understand the current game state
3. Selects and executes actions based on the detected state of the game

## Example Result


## Computer Vision Approach
The agent relies entirely on visual input from the game window. Key regions such as the minimap are extracted and processed into binary masks to represent the game state. Using this information along with the estimated heading of the boss, the agent generates keyboard inputs that navigate the dungeon and pathfind toward the boss.

### Minimap Processing
The agent captures screenshots of the minimap and process them into multiple binary masks. These masks are combined to identify walkable spaces and define the navigable area for the current game state.

<div align="center">

  <!-- Top row: original minimap -->
  <figure style="display: inline-block; margin: 20px 0; text-align: center;">
    <figcaption><strong>Original Minimap</strong></figcaption>
    <img src="readme_imgs/minimap_ss.png"
         width="400"
         style="border: 1px solid #ccc; border-radius: 4px;" />
  </figure>

  <br>

  <!-- Middle row: 3 masks side-by-side -->
  <figure style="display: inline-block; margin: 0 10px; text-align: left; vertical-align: top;">
    <figcaption><strong>Sand Room Mask</strong></figcaption>
    <img src="readme_imgs/sand_room.png"
         width="200"
         style="border: 1px solid #ccc; border-radius: 4px;" />
  </figure>

  <figure style="display: inline-block; margin: 0 10px; text-align: center; vertical-align: top;">
    <figcaption><strong>Bridge Room Mask</strong></figcaption>
    <img src="readme_imgs/bridge_room.png"
         width="200"
         style="border: 1px solid #ccc; border-radius: 4px;" />
  </figure>

  <figure style="display: inline-block; margin: 0 10px; text-align: center; vertical-align: top;">
    <figcaption><strong>Room Mask</strong></figcaption>
    <img src="readme_imgs/room.png"
         width="200"
         style="border: 1px solid #ccc; border-radius: 4px;" />
  </figure>

  <br>

  <!-- Bottom row: final walkable map -->
  <figure style="display: inline-block; margin: 20px 0; text-align: center;">
    <figcaption><strong>Walkable Mask</strong></figcaption>
    <img src="readme_imgs/walkable_map.png"
         width="400"
         style="border: 1px solid #ccc; border-radius: 4px;" />
  </figure>

</div>



### Boss Heading
The agent also captures screenshots of the game window, where template matching is used to determine the direction of the quest icon. This provides an estimate of the general heading of the boss.

<div align="center">

  <figure style="display: inline-block; margin: 0 20px; vertical-align: top;">
    <figcaption><strong>Game Window</strong></figcaption>
    <img src="readme_imgs/game_window.png"
         width="300"
         style="border: 1px solid #ccc; border-radius: 4px;" />
  </figure>

  <figure style="display: inline-block; margin: 0 20px; vertical-align: top;">
    <figcaption><strong>Boss Heading Detection</strong></figcaption>
    <img src="readme_imgs/boss_heading.png"
         width="200"
         style="border: 1px solid #ccc; border-radius: 4px;" />
  </figure>

</div>



### Pathfinding
A set of global points of interest (POIs) is generated by finding the centers of connected components from a subset of binary masks produced during minimap processing. These POIs act as anchor points for navigation. The agent picks the POI that is best aligned with the estimated boss heading, and pathfinds towards it.